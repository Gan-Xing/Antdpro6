"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[665],{19054:function(V,R,r){var I=r(1413),_=r(91),U=r(67294),T=r(33518),w=r(85893),l=["fieldProps","request","params","proFieldProps"],B=function(v,y){var L=v.fieldProps,A=v.request,W=v.params,b=v.proFieldProps,c=(0,_.Z)(v,l);return(0,w.jsx)(T.Z,(0,I.Z)({valueType:"treeSelect",fieldProps:L,ref:y,request:A,params:W,filedConfig:{customLightMode:!0},proFieldProps:b},c))},j=U.forwardRef(B);R.Z=j},10442:function(V,R,r){var I=r(15009),_=r.n(I),U=r(99289),T=r.n(U),w=r(5574),l=r.n(w),B=r(55581),j=r(67294),N=function(y){var L=(0,j.useState)([]),A=l()(L,2),W=A[0],b=A[1],c=function(){var P=T()(_()().mark(function K(){var x;return _()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,B.et)(y,{pageSize:1e4});case 2:x=O.sent,x.success&&b(x.data);case 4:case"end":return O.stop()}},K)}));return function(){return P.apply(this,arguments)}}();return(0,j.useEffect)(function(){c().catch(console.error)},[]),{items:W,setItems:b}};R.Z=N},52782:function(V,R,r){r.r(R),r.d(R,{default:function(){return Te}});var I=r(13769),_=r.n(I),U=r(5574),T=r.n(U),w=r(15009),l=r.n(w),B=r(97857),j=r.n(B),N=r(99289),v=r.n(N),y=r(55581),L=r(51042),A=r(6110),W=r(17992),b=r(2236),c=r(12578),P=r(2453),K=r(36147),x=r(71577),D=r(67294),O=r(37476),k=r(12029),te=r(10442),le=r(34994),H=r(5966),ue=r(19054),a=r(85893),oe=function(){var s=(0,c.useIntl)();function u(d){return d.map(function(g){return{title:g.name,value:g.id,key:g.id,children:g.children?u(g.children):[]}})}var i=(0,te.Z)("/menus"),n=i.items,o=u(n);return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(le.A.Group,{children:[(0,a.jsx)(H.Z,{rules:[{required:!0,message:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.name.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u540D\u79F0"})}],label:s.formatMessage({id:"pages.roles.name",defaultMessage:"\u540D\u79F0"}),width:"md",name:"name"}),(0,a.jsx)(H.Z,{rules:[{required:!0,message:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.path.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u8DEF\u5F84"})}],label:s.formatMessage({id:"pages.permissions.path",defaultMessage:"\u8BF7\u6C42\u8DEF\u5F84"}),width:"md",name:"path"}),(0,a.jsx)(ue.Z,{name:"parentId",placeholder:s.formatMessage({id:"pages.searchTable.select.placeholder",defaultMessage:"\u8BF7\u9009\u62E9"}),allowClear:!0,width:"md",secondary:!0,label:s.formatMessage({id:"pages.menus.parentid",defaultMessage:"\u4E0A\u7EA7\u83DC\u5355"}),fieldProps:{showArrow:!1,filterTreeNode:!0,showSearch:!0,treeDefaultExpandAll:!0,autoClearSearchValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"},treeData:o}})]})})},J=oe,de=function(s){var u=s.open,i=s.onOpenChange,n=s.onFinish,o=(0,c.useIntl)(),d=k.Z.useForm(),g=T()(d,1),e=g[0];return(0,a.jsx)(O.Y,{form:e,title:o.formatMessage({id:"pages.searchTable.createForm.newMenus",defaultMessage:"\u65B0\u589E\u83DC\u5355"}),width:"380px",open:u,onOpenChange:i,onFinish:n,children:(0,a.jsx)(J,{form:e})})},ie=de,ce=r(31991),pe=r(85265),me=function(s){var u=s.onClose,i=s.open,n=s.currentRow,o=s.columns;return(0,a.jsx)(pe.Z,{width:"70%",open:i,onClose:u,closable:!1,children:(n==null?void 0:n.name)&&(0,a.jsx)(ce.vY,{column:2,title:n==null?void 0:n.name,request:v()(l()().mark(function d(){return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:n||{}});case 1:case"end":return e.stop()}},d)})),params:{id:n==null?void 0:n.name},columns:o})})},ve=me,fe=r(96365),he=function(s){var u=s.updateModalOpen,i=s.onCancel,n=s.onSubmit,o=s.values,d=(0,c.useIntl)();return(0,a.jsxs)(O.Y,{title:d.formatMessage({id:"pages.searchTable.createForm.newUser",defaultMessage:"\u65B0\u5EFA\u7528\u6237"}),width:"70%",modalProps:{destroyOnClose:!0,maskClosable:!1},open:u,onOpenChange:i,onFinish:n,initialValues:j()({},o),children:[(0,a.jsx)(J,{permissions:o.permissions}),(0,a.jsx)(k.Z.Item,{name:"id",label:!1,children:(0,a.jsx)(fe.Z,{type:"hidden"})})]})},ge=he,Me=["children"],Fe=function(){var C=v()(l()().mark(function s(u){var i,n,o,d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=P.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,e.next=4,(0,y.$)("/menus",j()({},u));case 4:return i(),P.ZP.success("Added successfully"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),i(),P.ZP.error((n=e.t0===null||e.t0===void 0||(o=e.t0.response)===null||o===void 0||(d=o.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"Adding failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},s,null,[[1,9]])}));return function(u){return C.apply(this,arguments)}}(),je=function(){var C=v()(l()().mark(function s(u){var i,n,o,d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=P.ZP.loading("\u6B63\u5728\u66F4\u65B0"),e.prev=1,e.next=4,(0,y.$G)("/menus/".concat(u.id),u);case 4:return i(),P.ZP.success("\u66F4\u65B0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),i(),P.ZP.error((n=e.t0===null||e.t0===void 0||(o=e.t0.response)===null||o===void 0||(d=o.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"\u66F4\u65B0\u5931\u8D25,\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},s,null,[[1,9]])}));return function(u){return C.apply(this,arguments)}}(),X=function(){var C=v()(l()().mark(function s(u){var i,n,o,d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=P.ZP.loading("\u6B63\u5728\u5220\u9664"),u){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,y.cl)("/menus",{ids:u});case 6:return i(),P.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),i(),P.ZP.error((n=e.t0===null||e.t0===void 0||(o=e.t0.response)===null||o===void 0||(d=o.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"Delete failed, please try again"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},s,null,[[3,11]])}));return function(u){return C.apply(this,arguments)}}(),Pe=function(){var s=(0,D.useState)(!1),u=T()(s,2),i=u[0],n=u[1],o=(0,D.useState)(!1),d=T()(o,2),g=d[0],e=d[1],Ce=(0,D.useState)(),q=T()(Ce,2),ee=q[0],Q=q[1],ye=(0,D.useState)([]),re=T()(ye,2),E=re[0],Y=re[1],Oe=(0,D.useState)(!1),ae=T()(Oe,2),De=ae[0],ne=ae[1],S=(0,D.useRef)(),Ee=(0,c.useIntl)(),se=[{title:(0,a.jsx)(c.FormattedMessage,{id:"pages.roles.name",defaultMessage:"\u540D\u79F0"}),dataIndex:"name",tip:"\u540D\u79F0",render:function(m,t){return(0,a.jsx)("a",{onClick:function(){Q(t),ne(!0)},children:m})}},{title:(0,a.jsx)(c.FormattedMessage,{id:"pages.users.createTime",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),hideInSearch:!0,dataIndex:"createdAt",valueType:"dateTime"},{title:(0,a.jsx)(c.FormattedMessage,{id:"pages.roles.updatedTime",defaultMessage:"\u66F4\u65B0\u65F6\u95F4"}),hideInSearch:!0,dataIndex:"updatedAt",valueType:"dateTime"},{title:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",fixed:"right",render:function(m,t){return[(0,a.jsx)("a",{onClick:function(){e(!0),Q(function(h){return j()(j()({},h),t)})},children:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.editting",defaultMessage:"\u7F16\u8F91"})},"update"),(0,a.jsx)("a",{onClick:function(){return K.Z.confirm({title:"\u786E\u8BA4\u5220\u9664\uFF1F",onOk:function(){var h=v()(l()().mark(function G(){var F,Z;return l()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,X([t.id]);case 2:Y([]),(F=S.current)===null||F===void 0||(Z=F.reloadAndRest)===null||Z===void 0||Z.call(F);case 4:case"end":return z.stop()}},G)}));function p(){return h.apply(this,arguments)}return p}(),content:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.delete",defaultMessage:"\u5220\u9664"})},"delete")]}}],Se=function M(m){return m.map(function(t){if(t.children&&t.children.length===0){var f=t.children,h=_()(t,Me);return h}else if(t.children)return j()(j()({},t),{},{children:M(t.children)});return t})};return(0,a.jsxs)(A._z,{children:[(0,a.jsx)(W.Z,{headerTitle:Ee.formatMessage({id:"menu.auth.menus",defaultMessage:"\u83DC\u5355\u7BA1\u7406"}),actionRef:S,pagination:{defaultPageSize:10},rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,a.jsxs)(x.ZP,{type:"primary",onClick:function(){n(!0)},children:[(0,a.jsx)(L.Z,{})," ",(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:function(){var M=v()(l()().mark(function m(t,f,h){var p,G,F;return l()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,(0,y.et)("/menus",t,f,h);case 2:return p=$.sent,G=p.data,F=Se(G),$.abrupt("return",{data:F});case 6:case"end":return $.stop()}},m)}));return function(m,t,f){return M.apply(this,arguments)}}(),columns:se,expandable:{},rowSelection:{onChange:function(m,t){Y(t)}}}),(E==null?void 0:E.length)>0&&(0,a.jsx)(b.S,{extra:(0,a.jsxs)("div",{children:[(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,a.jsx)("a",{style:{fontWeight:600},children:E.length})," ",(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0"]}),children:(0,a.jsx)(x.ZP,{type:"primary",danger:!0,onClick:function(){return K.Z.confirm({title:"\u786E\u8BA4\u5220\u9664\uFF1F",onOk:function(){var m=v()(l()().mark(function f(){var h,p;return l()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,X(E==null?void 0:E.map(function(Z){return Z.id}));case 2:Y([]),(h=S.current)===null||h===void 0||(p=h.reloadAndRest)===null||p===void 0||p.call(h);case 4:case"end":return F.stop()}},f)}));function t(){return m.apply(this,arguments)}return t}(),content:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,a.jsx)(c.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,a.jsx)(ge,{onSubmit:function(){var M=v()(l()().mark(function m(t){var f;return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,je(t);case 2:f=p.sent,f&&(e(!1),Q(void 0),S.current&&S.current.reload());case 4:case"end":return p.stop()}},m)}));return function(m){return M.apply(this,arguments)}}(),onCancel:e,updateModalOpen:g,values:ee||{}}),(0,a.jsx)(ie,{open:i,onOpenChange:n,onFinish:function(){var M=v()(l()().mark(function m(t){var f;return l()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Fe(t);case 2:f=p.sent,f&&(n(!1),S.current&&S.current.reload());case 4:case"end":return p.stop()}},m)}));return function(m){return M.apply(this,arguments)}}()}),(0,a.jsx)(ve,{open:De,currentRow:ee,columns:se,onClose:function(){Q(void 0),ne(!1)}})]})},Te=Pe}}]);
