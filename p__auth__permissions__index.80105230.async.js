"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[250],{64317:function(k,A,r){var P=r(1413),h=r(91),x=r(22270),o=r(67294),Z=r(66758),D=r(33518),b=r(85893),v=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],y=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],T=o.forwardRef(function(s,_){var I=s.fieldProps,M=s.children,j=s.params,U=s.proFieldProps,C=s.mode,N=s.valueEnum,G=s.request,Q=s.showSearch,V=s.options,a=(0,h.Z)(s,v),z=(0,o.useContext)(Z.Z);return(0,b.jsx)(D.Z,(0,P.Z)((0,P.Z)({valueEnum:(0,x.h)(N),request:G,params:j,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,P.Z)({options:V,mode:C,showSearch:Q,getPopupContainer:z.getPopupContainer},I),ref:_,proFieldProps:U},a),{},{children:M}))}),L=o.forwardRef(function(s,_){var I=s.fieldProps,M=s.children,j=s.params,U=s.proFieldProps,C=s.mode,N=s.valueEnum,G=s.request,Q=s.options,V=(0,h.Z)(s,y),a=(0,P.Z)({options:Q,mode:C||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},I),z=(0,o.useContext)(Z.Z);return(0,b.jsx)(D.Z,(0,P.Z)((0,P.Z)({valueEnum:(0,x.h)(N),request:G,params:j,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,P.Z)({getPopupContainer:z.getPopupContainer},a),ref:_,proFieldProps:U},V),{},{children:M}))}),B=T,$=L,l=B;l.SearchSelect=$,l.displayName="ProFormComponent",A.Z=l},19054:function(k,A,r){var P=r(1413),h=r(91),x=r(67294),o=r(33518),Z=r(85893),D=["fieldProps","request","params","proFieldProps"],b=function(T,L){var B=T.fieldProps,$=T.request,l=T.params,s=T.proFieldProps,_=(0,h.Z)(T,D);return(0,Z.jsx)(o.Z,(0,P.Z)({valueType:"treeSelect",fieldProps:B,ref:L,request:$,params:l,filedConfig:{customLightMode:!0},proFieldProps:s},_))},v=x.forwardRef(b);A.Z=v},10442:function(k,A,r){var P=r(15009),h=r.n(P),x=r(99289),o=r.n(x),Z=r(5574),D=r.n(Z),b=r(55581),v=r(67294),y=function(L){var B=(0,v.useState)([]),$=D()(B,2),l=$[0],s=$[1],_=function(){var I=o()(h()().mark(function M(){var j;return h()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,b.et)(L,{pageSize:1e4});case 2:j=C.sent,j.success&&s(j.data);case 4:case"end":return C.stop()}},M)}));return function(){return I.apply(this,arguments)}}();return(0,v.useEffect)(function(){_().catch(console.error)},[]),{items:l,setItems:s}};A.Z=y},53613:function(k,A,r){r.r(A),r.d(A,{default:function(){return Fe}});var P=r(5574),h=r.n(P),x=r(15009),o=r.n(x),Z=r(97857),D=r.n(Z),b=r(99289),v=r.n(b),y=r(55581),T=r(51042),L=r(6110),B=r(17992),$=r(2236),l=r(12578),s=r(2453),_=r(36147),I=r(71577),M=r(67294),j=r(37476),U=r(12029),C=r(10442),N=r(34994),G=r(5966),Q=r(64317),V=r(19054),a=r(85893),z=function(){var t=(0,l.useIntl)();function i(d){return d.map(function(f){return{title:f.name,value:f.id,key:f.id,children:f.children?i(f.children):[]}})}var p=(0,C.Z)("/permissiongroups"),n=p.items,u=i(n);return console.log("permissiongroups",u),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(N.A.Group,{children:[(0,a.jsx)(G.Z,{rules:[{required:!0,message:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.name.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u540D\u79F0"})}],label:t.formatMessage({id:"pages.roles.name",defaultMessage:"\u540D\u79F0"}),width:"md",name:"name"}),(0,a.jsx)(G.Z,{rules:[{required:!0,message:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.path.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u8DEF\u5F84"})}],label:t.formatMessage({id:"pages.permissions.path",defaultMessage:"\u8BF7\u6C42\u8DEF\u5F84"}),width:"md",name:"path"}),(0,a.jsx)(Q.Z,{name:"action",label:t.formatMessage({id:"pages.permissions.method",defaultMessage:"\u8BF7\u6C42\u65B9\u6CD5"}),valueEnum:{GET:"GET",POST:"POST",DELETE:"DELETE",PUT:"PUT",PATCH:"PATCH"},width:"md",placeholder:t.formatMessage({id:"pages.searchTable.select.placeholder",defaultMessage:"\u8BF7\u9009\u62E9"}),rules:[{required:!0,message:(0,a.jsx)(l.FormattedMessage,{id:"pages.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\uFF01"})}]}),(0,a.jsx)(V.Z,{name:"permissionGroupId",placeholder:t.formatMessage({id:"pages.searchTable.select.placeholder",defaultMessage:"\u8BF7\u9009\u62E9"}),allowClear:!0,width:"md",secondary:!0,label:t.formatMessage({id:"pages.permissions.permissionGroup",defaultMessage:" \u9009\u62E9\u6743\u9650\u7EC4"}),fieldProps:{showArrow:!1,filterTreeNode:!0,showSearch:!0,treeDefaultExpandAll:!0,autoClearSearchValue:!0,treeNodeFilterProp:"title",fieldNames:{label:"title"},treeData:u},rules:[{required:!0,message:(0,a.jsx)(l.FormattedMessage,{id:"pages.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\uFF01"})}]})]})})},ee=z,ue=function(t){var i=t.open,p=t.onOpenChange,n=t.onFinish,u=(0,l.useIntl)(),d=U.Z.useForm(),f=h()(d,1),e=f[0];return(0,a.jsx)(j.Y,{form:e,title:u.formatMessage({id:"pages.searchTable.createForm.newPermission",defaultMessage:"\u65B0\u5EFA\u6743\u9650"}),width:"380px",open:i,onOpenChange:p,onFinish:n,children:(0,a.jsx)(ee,{form:e})})},ie=ue,de=r(31991),pe=r(85265),me=function(t){var i=t.onClose,p=t.open,n=t.currentRow,u=t.columns;return(0,a.jsx)(pe.Z,{width:"70%",open:p,onClose:i,closable:!1,children:(n==null?void 0:n.name)&&(0,a.jsx)(de.vY,{column:2,title:n==null?void 0:n.name,request:v()(o()().mark(function d(){return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{data:n||{}});case 1:case"end":return e.stop()}},d)})),params:{id:n==null?void 0:n.name},columns:u})})},ce=me,ve=r(96365),he=function(t){var i=t.updateModalOpen,p=t.onCancel,n=t.onSubmit,u=t.values,d=(0,l.useIntl)(),f=U.Z.useForm(),e=h()(f,1),H=e[0];return(0,a.jsxs)(j.Y,{form:H,title:d.formatMessage({id:"pages.searchTable.createForm.newUser",defaultMessage:"\u65B0\u5EFA\u7528\u6237"}),width:"70%",modalProps:{destroyOnClose:!0,maskClosable:!1},open:i,onOpenChange:p,onFinish:n,initialValues:D()({},u),children:[(0,a.jsx)(ee,{permissions:u.permissions,form:H}),(0,a.jsx)(U.Z.Item,{name:"id",label:!1,children:(0,a.jsx)(ve.Z,{type:"hidden"})})]})},fe=he,ge=function(){var O=v()(o()().mark(function t(i){var p,n,u,d;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p=s.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,e.next=4,(0,y.$)("/permissions",D()({},i));case 4:return p(),s.ZP.success("Added successfully"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),p(),s.ZP.error((n=e.t0===null||e.t0===void 0||(u=e.t0.response)===null||u===void 0||(d=u.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"Adding failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},t,null,[[1,9]])}));return function(i){return O.apply(this,arguments)}}(),Pe=function(){var O=v()(o()().mark(function t(i){var p,n,u,d;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p=s.ZP.loading("\u6B63\u5728\u66F4\u65B0"),e.prev=1,e.next=4,(0,y.$G)("/permissions/".concat(i.id),i);case 4:return p(),s.ZP.success("\u66F4\u65B0\u6210\u529F"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),p(),s.ZP.error((n=e.t0===null||e.t0===void 0||(u=e.t0.response)===null||u===void 0||(d=u.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"\u66F4\u65B0\u5931\u8D25,\u8BF7\u91CD\u8BD5"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},t,null,[[1,9]])}));return function(i){return O.apply(this,arguments)}}(),re=function(){var O=v()(o()().mark(function t(i){var p,n,u,d;return o()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p=s.ZP.loading("\u6B63\u5728\u5220\u9664"),i){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,y.cl)("/permissions",{ids:i});case 6:return p(),s.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),p(),s.ZP.error((n=e.t0===null||e.t0===void 0||(u=e.t0.response)===null||u===void 0||(d=u.data)===null||d===void 0?void 0:d.message)!==null&&n!==void 0?n:"Delete failed, please try again"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},t,null,[[3,11]])}));return function(i){return O.apply(this,arguments)}}(),Me=function(){var t=(0,M.useState)(!1),i=h()(t,2),p=i[0],n=i[1],u=(0,M.useState)(!1),d=h()(u,2),f=d[0],e=d[1],H=(0,M.useState)(!1),ae=h()(H,2),Ee=ae[0],se=ae[1],w=(0,M.useRef)(),Ce=(0,M.useState)(),ne=h()(Ce,2),te=ne[0],J=ne[1],Te=(0,M.useState)([]),oe=h()(Te,2),W=oe[0],q=oe[1],_e=(0,l.useIntl)(),le=[{title:(0,a.jsx)(l.FormattedMessage,{id:"pages.permission.name",defaultMessage:"\u6743\u9650\u540D\u79F0"}),dataIndex:"name",tip:"\u540D\u79F0",render:function(m,g){return(0,a.jsx)("a",{onClick:function(){J(g),se(!0)},children:m})}},{title:(0,a.jsx)(l.FormattedMessage,{id:"pages.permissions.group",defaultMessage:"\u6240\u5C5E\u6743\u9650\u7EC4"}),dataIndex:"permissionGroup",renderText:function(m){return"".concat(m.parent.name,"-").concat(m.name)},hideInSearch:!0},{title:(0,a.jsx)(l.FormattedMessage,{id:"pages.users.createTime",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),hideInSearch:!0,dataIndex:"createdAt",valueType:"dateTime"},{title:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"\u64CD\u4F5C"}),dataIndex:"option",valueType:"option",fixed:"right",render:function(m,g){return[(0,a.jsx)("a",{onClick:function(){e(!0),J(g)},children:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.editting",defaultMessage:"\u7F16\u8F91"})},"update"),(0,a.jsx)("a",{onClick:function(){return _.Z.confirm({title:"\u786E\u8BA4\u5220\u9664\uFF1F",onOk:function(){var S=v()(o()().mark(function K(){var R,Y;return o()().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,re([g.id]);case 2:q([]),(R=w.current)===null||R===void 0||(Y=R.reloadAndRest)===null||Y===void 0||Y.call(R);case 4:case"end":return X.stop()}},K)}));function c(){return S.apply(this,arguments)}return c}(),content:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.delete",defaultMessage:"\u5220\u9664"})},"delete")]}}];return(0,a.jsxs)(L._z,{children:[(0,a.jsx)(B.Z,{headerTitle:_e.formatMessage({id:"menu.auth.permissions",defaultMessage:"\u6743\u9650\u7BA1\u7406"}),actionRef:w,pagination:{defaultPageSize:10},rowKey:"id",search:{labelWidth:120},toolBarRender:function(){return[(0,a.jsxs)(I.ZP,{type:"primary",onClick:function(){n(!0)},children:[(0,a.jsx)(T.Z,{})," ",(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:function(){var E=v()(o()().mark(function m(g,F,S){return o()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.abrupt("return",(0,y.et)("/permissions",g,F,S));case 1:case"end":return K.stop()}},m)}));return function(m,g,F){return E.apply(this,arguments)}}(),columns:le,rowSelection:{onChange:function(m,g){q(g)}}}),(W==null?void 0:W.length)>0&&(0,a.jsx)($.S,{extra:(0,a.jsxs)("div",{children:[(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,a.jsx)("a",{style:{fontWeight:600},children:W.length})," ",(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0"]}),children:(0,a.jsx)(I.ZP,{type:"primary",danger:!0,onClick:function(){return _.Z.confirm({title:"\u786E\u8BA4\u5220\u9664\uFF1F",onOk:function(){var m=v()(o()().mark(function F(){var S,c;return o()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,re(W==null?void 0:W.map(function(Y){return Y.id}));case 2:q([]),(S=w.current)===null||S===void 0||(c=S.reloadAndRest)===null||c===void 0||c.call(S);case 4:case"end":return R.stop()}},F)}));function g(){return m.apply(this,arguments)}return g}(),content:"\u786E\u8BA4\u5220\u9664\u5417\uFF1F",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88"})},children:(0,a.jsx)(l.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,a.jsx)(ie,{open:p,onOpenChange:n,onFinish:function(){var E=v()(o()().mark(function m(g){var F;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ge(g);case 2:F=c.sent,F&&(n(!1),w.current&&w.current.reload());case 4:case"end":return c.stop()}},m)}));return function(m){return E.apply(this,arguments)}}()}),(0,a.jsx)(fe,{onSubmit:function(){var E=v()(o()().mark(function m(g){var F;return o()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Pe(g);case 2:F=c.sent,F&&(e(!1),J(void 0),w.current&&w.current.reload());case 4:case"end":return c.stop()}},m)}));return function(m){return E.apply(this,arguments)}}(),onCancel:e,updateModalOpen:f,values:te||{}}),(0,a.jsx)(ce,{open:Ee,currentRow:te,columns:le,onClose:function(){J(void 0),se(!1)}})]})},Fe=Me}}]);
